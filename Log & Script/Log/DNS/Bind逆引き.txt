[root@honban ~]$ vi /etc/named.conf
------------------------------------------------------------------------------
      1 //
      2 // named.conf
      3 //
      4 // Provided by Red Hat bind package to configure the ISC BIND named(8) DNS
      5 // server as a caching only nameserver (as a localhost DNS resolver only).
      6 //
      7 // See /usr/share/doc/bind*/sample/ for example named configuration files.
      8 //
      9 // See the BIND Administrator's Reference Manual (ARM) for details about the
     10 // configuration located in /usr/share/doc/bind-{version}/Bv9ARM.html
     11 
     12 options {
     13    listen-on port 53 { 127.0.0.1; };
     14    listen-on port 53 { 192.168.3.10; };
     15    listen-on-v6 port 53 { ::1; };
     16    directory   "/var/named";
     17    dump-file   "/var/named/data/cache_dump.db";
     18    statistics-file "/var/named/data/named_stats.txt";
     19    memstatistics-file "/var/named/data/named_mem_stats.txt";
     20    recursing-file  "/var/named/data/named.recursing";
     21    secroots-file   "/var/named/data/named.secroots";
     22    allow-query     { 192.168.3.0/24; localhost; };
     23    recursion yes;
     24    forwarders { 8.8.8.8; };
     25    allow-recursion { 192.168.3.0/24;  };
     26 

　　　62 
     63 zone "example.com" {
     64     type master;
     65     file "/var/named/example.com.zone";
     66     allow-transfer { 192.168.3.11; };
     67 };
     68 
     69 zone "3.168.192.in-addr.arpa" IN {
     70     type master;
     71     file "/var/named/3.168.192.in-addr.arpa.zone";
     72     allow-update { none; };
     73 };
     74 

------------------------------------------------------------------------------
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ vi /var/named/3.168.192.in-addr.arpa.zone
------------------------------------------------------------------------------
      1 $TTL 86400
      2 @   IN  SOA     honban.example.com. root.example.com. (
      3                   2022031801  ; Serial
      4                   3600       ; Refresh
      5                   1800       ; Retry
      6                   604800     ; Expire
      7                   86400      ; Minimum TTL
      8                 )
      9 
     10 @            IN  NS      honban.example.com.
     11 
     12 10           IN  PTR     honban.example.com.
     13 11           IN  PTR     deploy.example.com.
     14 200          IN  PTR     ansible.example.com.
     15 
------------------------------------------------------------------------------
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ vi /etc/hosts
------------------------------------------------------------------------------
      1 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
      2 ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
      3 
      4 192.168.3.10 honban honban.example.com
      5 192.168.3.11   deploy deploy.example.com
      6 192.168.3.200  ansible ansible.example.com
      7 192.168.3.7 sample
      8 192.168.3.12 Bind

------------------------------------------------------------------------------
[root@honban ~]$
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ vi /etc/resolv.conf
------------------------------------------------------------------------------
      1 # Generated by NetworkManager
      2 nameserver 192.168.3.10
      3 nameserver 192.168.3.1
                             
------------------------------------------------------------------------------
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ dig -x 192.168.3.200

; <<>> DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.13 <<>> -x 192.168.3.200
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 10698
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;200.3.168.192.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
200.3.168.192.in-addr.arpa. 86400 IN	PTR	ansible.example.com.

;; AUTHORITY SECTION:
3.168.192.in-addr.arpa.	86400	IN	NS	honban.example.com.

;; ADDITIONAL SECTION:
honban.example.com.	86400	IN	A	192.168.3.10

;; Query time: 1 msec
;; SERVER: 192.168.3.10#53(192.168.3.10)
;; WHEN: 火  3月 21 16:17:53 JST 2023
;; MSG SIZE  rcvd: 125

[root@honban ~]$ 
[root@honban ~]$ dig -x 192.168.3.11

; <<>> DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.13 <<>> -x 192.168.3.11
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 42485
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;11.3.168.192.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
11.3.168.192.in-addr.arpa. 86400 IN	PTR	deploy.example.com.

;; AUTHORITY SECTION:
3.168.192.in-addr.arpa.	86400	IN	NS	honban.example.com.

;; ADDITIONAL SECTION:
honban.example.com.	86400	IN	A	192.168.3.10

;; Query time: 0 msec
;; SERVER: 192.168.3.10#53(192.168.3.10)
;; WHEN: 火  3月 21 16:18:47 JST 2023
;; MSG SIZE  rcvd: 123

[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ dig -x 192.168.3.10

; <<>> DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.13 <<>> -x 192.168.3.10
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 41585
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;10.3.168.192.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
10.3.168.192.in-addr.arpa. 86400 IN	PTR	honban.example.com.

;; AUTHORITY SECTION:
3.168.192.in-addr.arpa.	86400	IN	NS	honban.example.com.

;; ADDITIONAL SECTION:
honban.example.com.	86400	IN	A	192.168.3.10

;; Query time: 0 msec
;; SERVER: 192.168.3.10#53(192.168.3.10)
;; WHEN: 火  3月 21 16:18:51 JST 2023
;; MSG SIZE  rcvd: 116

[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ nslookup 192.168.3.200
200.3.168.192.in-addr.arpa	name = ansible.example.com.

[root@honban ~]$ 
[root@honban ~]$ nslookup 192.168.3.10
10.3.168.192.in-addr.arpa	name = honban.example.com.

[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ nslookup 192.168.3.11
11.3.168.192.in-addr.arpa	name = deploy.example.com.

[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ host 192.168.3.11
11.3.168.192.in-addr.arpa domain name pointer deploy.example.com.
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ host 192.168.3.10
10.3.168.192.in-addr.arpa domain name pointer honban.example.com.
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ host 192.168.3.200
200.3.168.192.in-addr.arpa domain name pointer ansible.example.com.
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ host deploy.example.com.
deploy.example.com has address 192.168.3.11
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ host honban.example.com.
honban.example.com has address 192.168.3.10
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ host ansible.example.com.
ansible.example.com has address 192.168.3.200
[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ nslookup deploy.example.com.
Server:		192.168.3.10
Address:	192.168.3.10#53

Name:	deploy.example.com
Address: 192.168.3.11

[root@honban ~]$ 
[root@honban ~]$ nslookup honban.example.com.
Server:		192.168.3.10
Address:	192.168.3.10#53

Name:	honban.example.com
Address: 192.168.3.10

[root@honban ~]$ 
[root@honban ~]$ 
[root@honban ~]$ nslookup ansible.example.com.
Server:		192.168.3.10
Address:	192.168.3.10#53

Name:	ansible.example.com
Address: 192.168.3.200

[root@honban ~]$ 
[root@honban ~]$ 




# スレーブサーバ
[root@ansible ~]# vi /etc/named.conf
------------------------------------------------------------------------------
      1 //
      2 // named.conf
      3 //
      4 // Provided by Red Hat bind package to configure the ISC BIND named(8) DNS
      5 // server as a caching only nameserver (as a localhost DNS resolver only).
      6 //
      7 // See /usr/share/doc/bind*/sample/ for example named configuration files.
      8 //
      9 // See the BIND Administrator's Reference Manual (ARM) for details about the
     10 // configuration located in /usr/share/doc/bind-{version}/Bv9ARM.html
     11 
     12 options {
     13    listen-on port 53 { 127.0.0.1; };
     14    listen-on port 53 { 192.168.3.200; };
     15    listen-on-v6 port 53 { ::1; };
     16    directory   "/var/named";
     17    dump-file   "/var/named/data/cache_dump.db";
     18    statistics-file "/var/named/data/named_stats.txt";
     19    memstatistics-file "/var/named/data/named_mem_stats.txt";
     20    recursing-file  "/var/named/data/named.recursing";
     21    secroots-file   "/var/named/data/named.secroots";
     22    allow-query     { 192.168.3.0/24; localhost; };
     23    forwarders { 8.8.8.8; };
     24    allow-recursion { 192.168.3.0/24;  };
     25 

     62 
     63 zone "example.com" {
     64    type slave;
     65    file "/var/named/example.com.zone";
     66    masters { 192.168.3.10; };
     67 };
     68 

------------------------------------------------------------------------------
[root@ansible ~]# 
[root@ansible ~]# systemctl restart named.service 
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# vi /etc/hosts
------------------------------------------------------------------------------

      1 127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
      2 ::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
      3 test-machine ansible_host=127.0.0.1
      4 192.168.3.11 deploy deploy.example.com
      5 192.168.3.10 honban.example.com honban

------------------------------------------------------------------------------
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# vi /etc/resolv.conf
------------------------------------------------------------------------------

      1 # Generated by NetworkManager
      2 nameserver 192.168.3.10
      3 nameserver 192.168.3.1

------------------------------------------------------------------------------
[root@ansible ~]# 
[root@ansible ~]# nslookup 192.168.3.10
10.3.168.192.in-addr.arpa	name = honban.example.com.

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# nslookup 192.168.3.11
11.3.168.192.in-addr.arpa	name = deploy.example.com.

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# nslookup 192.168.3.200
200.3.168.192.in-addr.arpa	name = ansible.example.com.

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# nslookup ansible.example.com.
Server:		192.168.3.10
Address:	192.168.3.10#53

Name:	ansible.example.com
Address: 192.168.3.200

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# nslookup honban.example.com.
Server:		192.168.3.10
Address:	192.168.3.10#53

Name:	honban.example.com
Address: 192.168.3.10

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# nslookup deploy.example.com.
Server:		192.168.3.10
Address:	192.168.3.10#53

Name:	deploy.example.com
Address: 192.168.3.11

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# dig -x 192.168.3.10

; <<>> DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.13 <<>> -x 192.168.3.10
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 65050
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;10.3.168.192.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
10.3.168.192.in-addr.arpa. 86400 IN	PTR	honban.example.com.

;; AUTHORITY SECTION:
3.168.192.in-addr.arpa.	86400	IN	NS	honban.example.com.

;; ADDITIONAL SECTION:
honban.example.com.	86400	IN	A	192.168.3.10

;; Query time: 1 msec
;; SERVER: 192.168.3.10#53(192.168.3.10)
;; WHEN: 火  3月 21 16:31:51 JST 2023
;; MSG SIZE  rcvd: 116

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# dig -x 192.168.3.11

; <<>> DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.13 <<>> -x 192.168.3.11
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 53143
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;11.3.168.192.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
11.3.168.192.in-addr.arpa. 86400 IN	PTR	deploy.example.com.

;; AUTHORITY SECTION:
3.168.192.in-addr.arpa.	86400	IN	NS	honban.example.com.

;; ADDITIONAL SECTION:
honban.example.com.	86400	IN	A	192.168.3.10

;; Query time: 2 msec
;; SERVER: 192.168.3.10#53(192.168.3.10)
;; WHEN: 火  3月 21 16:31:56 JST 2023
;; MSG SIZE  rcvd: 123

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# dig -x 192.168.3.200

; <<>> DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.13 <<>> -x 192.168.3.200
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 40624
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;200.3.168.192.in-addr.arpa.	IN	PTR

;; ANSWER SECTION:
200.3.168.192.in-addr.arpa. 86400 IN	PTR	ansible.example.com.

;; AUTHORITY SECTION:
3.168.192.in-addr.arpa.	86400	IN	NS	honban.example.com.

;; ADDITIONAL SECTION:
honban.example.com.	86400	IN	A	192.168.3.10

;; Query time: 3 msec
;; SERVER: 192.168.3.10#53(192.168.3.10)
;; WHEN: 火  3月 21 16:32:00 JST 2023
;; MSG SIZE  rcvd: 125

[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# host 192.168.3.10
10.3.168.192.in-addr.arpa domain name pointer honban.example.com.
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# host 192.168.3.11
11.3.168.192.in-addr.arpa domain name pointer deploy.example.com.
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# host 192.168.3.200
200.3.168.192.in-addr.arpa domain name pointer ansible.example.com.
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# host honban.example.com.
honban.example.com has address 192.168.3.10
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# host deploy.example.com.
deploy.example.com has address 192.168.3.11
[root@ansible ~]# 
[root@ansible ~]# 
[root@ansible ~]# host ansible.example.com.
ansible.example.com has address 192.168.3.200
[root@ansible ~]# 















